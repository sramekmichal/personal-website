[{"content":"\u003cp\u003eFollowing text involves AWS native tools for the continuous monitoring of activities within an AWS environment to detect and respond to security threats and breaches.\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eIt encompasses the discovery collection of best practices\u003c/em\u003e, how to achieve this goal.\u003c/u\u003e Implementing this \u003cu\u003esecure\u003c/u\u003e \u003cstrong\u003eActivity Monitoring and Audit in AWS\u003c/strong\u003e, will enhance security posture, mitigate risks, and better protect all AWS resources and sensitive data from unauthorised access or malicious activities.\u003c/p\u003e\n\u003cp\u003eEvery decision made in AWS environment should be in accordance with the \u003ca href=\"https://docs.aws.amazon.com/prescriptive-guidance/latest/security-reference-architecture/architecture.html\"\u003eAWS Security Reference Architecture\u003c/a\u003e. This involves understanding the principles outlined in the architecture, conducting a risk assessment to identify potential security risks, and designing AWS architecture to incorporate security controls at every layer.\u003c/p\u003e\n\u003ch2 id=\"framework\"\u003eFramework\u003c/h2\u003e\n\u003cp\u003eI personally recommend \u0026ldquo;internal audit framework\u0026rdquo; which is in compliance with AWS and should include the following (16) steps:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eStart to use \u003ca href=\"https://docs.aws.amazon.com/prescriptive-guidance/latest/migration-aws-environment/understanding-landing-zones.html\"\u003eAWS Landing Zone\u003c/a\u003e with \u003ca href=\"https://digitalcloud.training/what-is-aws-control-tower/\"\u003eAWS Control Tower\u003c/a\u003e (\u003ca href=\"https://docs.aws.amazon.com/organizations/latest/userguide/orgs_introduction.html\"\u003eAWS Organizations\u003c/a\u003e)\u003c/strong\u003e\u003c/em\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eAWS Landing Zone primarily sets up the initial infrastructure (multi-account AWS environment, core infrastructure components like networking and IAM). AWS Control Tower provides ongoing management and enforcement of security and compliance controls (centralised governance, compliance capabilities and enforcing policies across entire AWS environment). AWS Organizations is the underlying AWS service of AWS Control Tower.\u003c/p\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eTurn on \u003ca href=\"https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-user-guide.html\"\u003eAWS CloudTrail\u003c/a\u003e in each AWS account\u003c/strong\u003e\u003c/em\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eAWS CloudTrail logs can be analysed in real-time to detect unauthorised access attempts or changes to critical resources. Integration with monitoring tools enables proactive threat detection and compliance monitoring across the AWS environment.\u003c/p\u003e\n\u003col start=\"3\"\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eStore \u003ca href=\"https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-log-file-examples.html\"\u003eAWS CloudTrail log\u003c/a\u003e in a centralised logging account with very restricted access\u003c/strong\u003e\u003c/em\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eProper stream log management and analysis processes enable more efficient threat detection and incident response. Restricting access to the centralised logging account minimises the risk of unauthorised access, ensuring data confidentiality and integrity.\u003c/p\u003e\n\u003col start=\"4\"\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eCreate \u003ca href=\"https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/cloudwatch_architecture.html\"\u003eAWS CloudWatch\u003c/a\u003e alarms for specific API calls\u003c/strong\u003e\u003c/em\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eReal-time notification alarms of critical events for specific API calls (high-volume data transfers, sensitive resource modifications) should be enabled. These alarms serve as proactive measures. AWS CloudWatch Logs Insights can also search API history beyond the last 90 days. Additional useful info \u003ca href=\"https://medium.com/free-code-camp/how-to-auto-create-cloudwatch-alarms-for-apis-with-cloudwatch-events-and-lambda-b128920857aa\"\u003eHERE\u003c/a\u003e.\u003c/p\u003e\n\u003col start=\"5\"\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eUse Logging IP traffic for VPCs and DNS logs\u003c/strong\u003e\u003c/em\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eObtaining valuable informations using \u003ca href=\"https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html\"\u003eVPC Flow Logs\u003c/a\u003e and \u003ca href=\"https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resolver-query-logs.html\"\u003eAmazon Route 53 resolver query logs\u003c/a\u003e and streaming them to either an Amazon S3 bucket or a CloudWatch log group is crucial.\u003c/p\u003e\n\u003col start=\"6\"\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003ePeriodically examine “AWS log files” with \u003ca href=\"https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html\"\u003eAWS GuardDuty\u003c/a\u003e\u003c/strong\u003e\u003c/em\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThis process enhances activity monitoring in AWS by proactively identifying security threats and suspicious activities. AWS GuardDuty can automatically analyse threat detection of AWS CloudTrail Events, VPC Flow Logs, DNS Logs and generally alerts to unexpected activity.\u003c/p\u003e\n\u003col start=\"7\"\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eEnable \u003ca href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/logging-with-S3.html\"\u003eAWS S3 buckets logging\u003c/a\u003e to monitor requests made to each bucket\u003c/strong\u003e\u003c/em\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eIt allows to monitor requests made to each bucket and track access attempts, changes, and other activities. Analysing S3 access logs can help identify unauthorised access attempts, data breaches or misconfigurations.\u003c/p\u003e\n\u003col start=\"8\"\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eUse \u003ca href=\"https://docs.aws.amazon.com/appconfig/latest/userguide/what-is-appconfig.html\"\u003eAWS Config\u003c/a\u003e for viewing historical IAM configuration and changes over time\u003c/strong\u003e\u003c/em\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eAWS Config is enabling to view the IAM policy that was assigned to a user, group, or role at any time. It is basically resource inventory (existing as well as deleted).\u003c/p\u003e\n\u003col start=\"9\"\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eCollect alerts for IAM configuration changes and their audits\u003c/strong\u003e\u003c/em\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eBy setting up alerts we can be notified on IAM configuration changes. Additional useful info \u003ca href=\"https://aws.amazon.com/blogs/security/how-to-receive-alerts-when-your-iam-configuration-changes/\"\u003eHERE\u003c/a\u003e.\u003c/p\u003e\n\u003col start=\"10\"\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eSet up \u003ca href=\"https://docs.aws.amazon.com/detective/latest/adminguide/what-is-detective.html\"\u003eAWS Detective\u003c/a\u003e controls around user creation and using a user credentials\u003c/strong\u003e\u003c/em\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eIt is need to be implemented together with AWS Config when a new user or group is created and for any API actions performed by a non-federated IAM principal.\u003c/p\u003e\n\u003col start=\"11\"\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003ePeriodically generate and download IAM credential report\u003c/strong\u003e\u003c/em\u003e \u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eReport can be used to audit the effects of credential lifecycle requirements (lists all users,  status of their passwords, access key updates and MFA devices). It can be further reported to an external auditor.\u003c/p\u003e\n\u003col start=\"12\"\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eCheck regularly the \u003ca href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html\"\u003eAWS IAM Access Analyzer\u003c/a\u003e\u003c/strong\u003e\u003c/em\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eAchieving least privilege and grant the right fine-grained permissions. It provides capabilities to set, verify, and refine permissions, analyse external access and validate, that policies match corporate security standards.\u003c/p\u003e\n\u003col start=\"13\"\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eAudit session activity using \u003ca href=\"https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-what-is.html\"\u003eAWS EventBridge\u003c/a\u003e\u003c/strong\u003e\u003c/em\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eSet up rules to detect when changes happen to any AWS resources. It provides comprehensive visibility into user actions and system events.\u003c/p\u003e\n\u003col start=\"14\"\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eEnable the session activity logging in \u003ca href=\"https://docs.aws.amazon.com/systems-manager/latest/userguide/what-is-systems-manager.html\"\u003eAWS Systems Manager\u003c/a\u003e\u003c/strong\u003e\u003c/em\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eContinual stream of session data logs to AWS CloudWatch Logs with details (user’s commands in a session, the ID of the user and timestamps). Additional useful info \u003ca href=\"https://aws.amazon.com/blogs/security/how-to-record-ssh-sessions-established-through-a-bastion-host/\"\u003eHERE\u003c/a\u003e.\u003c/p\u003e\n\u003col start=\"15\"\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eUse \u003ca href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_access-advisor.html\"\u003eAWS Access Advisor\u003c/a\u003e to refine set up permission guardrails\u003c/strong\u003e\u003c/em\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eIt analyses last accessed information in AWS accounts. Permission guardrails help control which services users and applications can access and determine the services not used by IAM users and roles. With service control policies (SCPs), access to those services can be restricted.\u003c/p\u003e\n\u003col start=\"16\"\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eAutomatically collect and monitor evidence by \u003ca href=\"https://docs.aws.amazon.com/audit-manager/latest/userguide/what-is.html\"\u003eAWS Audit Manager\u003c/a\u003e\u003c/strong\u003e\u003c/em\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eProactive measure reducing risk by fine-tuning AWS controls. Evidence is a record that contains the information needed to demonstrate compliance with the requirements specified by a control. Examples of evidence could be a change activity triggered by a user, or a system configuration snapshot.\u003c/p\u003e\n\u003ch2 id=\"conclusion\"\u003eConclusion\u003c/h2\u003e\n\u003cp\u003eImplementing the above framework will help to ensure that the AWS environment is secure and compliant with security best practices. It will also help to detect and respond to security threats and breaches in a timely manner. By continuously monitoring activities within the AWS environment, organisations can better protect their resources and sensitive data from unauthorised access or malicious activities.\u003c/p\u003e\n","description":"Activity Monitoring and Audit in AWS","image":"/images/blogs/aws-security.jpg","permalink":"http://localhost:1313/blogs/activity-monitoring-and-audit-in-aws/","title":"Activity Monitoring and Audit in AWS"}]